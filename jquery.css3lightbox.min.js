(function(a){var b={width:400,height:300,css:{shadow:{"background-color":"#777",opacity:.7,cursor:"pointer",position:"fixed",left:0,top:0,bottom:0,right:0,"z-index":1e3},modal:{"background-color":"black",color:"white",position:"fixed","z-index":1001,border:"10px solid white","box-shadow":"0 0 15px #444","-moz-box-shadow":"0 0 15px #444","-webkit-box-shadow":"0 0 15px #444"},content:{"overflow-y":"auto",padding:10},close_button:{cursor:"pointer",position:"absolute",top:-20,right:-20,width:20,height:18,"border-radius":20,"-moz-border-radius":20,"-webkit-border-radius":20,"box-shadow":"5px 5px 5px #444","-moz-box-shadow":"5px 5px 5px #444","-webkit-box-shadow":"5px 5px 5px #444",border:"2px solid white",background:"black",color:"white","font-family":"sans-serif","font-size":14,"font-weight":"bold",padding:"2px 0 0 0px",margin:0,"text-align":"center"},spinner:{width:200,height:200,position:"absolute"},spinner_ball:{position:"absolute",width:5,height:5,"background-color":"white","border-radius":5,"-moz-border-radius":5,"-webkit-border-radius":5,"box-shadow":"0 0 2px #000","-moz-box-shadow":"0 0 2px #000","-webkit-box-shadow":"0 0 2px #000"}}},c,d,e,f,g,h=function(b){var c={modal:{width:b.width,height:b.height,left:(a(window).width()-b.width)/2,top:(a(window).height()-b.height)/2},spinner:{left:(b.width-b.css.spinner.width)/2,top:(b.height-b.css.spinner.height)/2},content:{height:b.height-b.css.content.padding*2,width:b.width-b.css.content.padding*2}};a.extend(!0,b.css,c)},i=!0,j=function(b){var c=[],e=Math.min(b.css.spinner.width,b.css.spinner.height),g=8,h=100;for(var j=0;j<g;j++)b.css.spinner_ball.top=e/2+25*Math.sin(Math.PI*2*j/g),b.css.spinner_ball.left=e/2+25*Math.cos(Math.PI*2*j/g),b.css.opacity=(7-j)/g,c.push(a("<div />",{css:b.css.spinner_ball}));a.each(c,function(){f.append(this)});var k=function(a){if(!i)return;c[a].stop(!0,!0).fadeTo(0,1).fadeOut(g*h*2),setTimeout(function(){k((a+1)%g)},h)};d.append(f),k(0)},k=function(){f.remove(),i=!1},l={create:function(i){i=a.extend(!0,{},b,i),h(i),c=a("<div />",{css:i.css.shadow}),d=a("<div />",{css:i.css.modal}),e=a("<div />",{css:i.css.content}),f=a("<div />",{css:i.css.spinner}),g=a("<div />",{css:i.css.close_button,text:"x"});var k=function(){d.remove(),c.remove()};c.click(k),g.click(k),d.append(g),a("body").append(c).append(d),j(i)},set_content:function(a){typeof a=="string"?(k(),e.html(a),d.append(e)):(a.width("100%"),a.height("100%"),d.append(a),a.hide(),a.load(function(){k(),a.show()}))}};a.extend({lightbox:l})})(jQuery);